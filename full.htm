<title>LZMA decoder</title><style>*{font-family:MS Gothic,monospace}
pre{border:1px solid #8f8;background:#cfc;font-size:.9em;overflow:auto}
iframe{height:3em;background:#ddd}
iframe,textarea{width:100%;display:block}
textarea{height:9em;background:#ccc;color:#333;padding:.5em}
em{border:1px solid #222;background:#bbb;color:#333}</style>
<h1>Tiny code of LZMA decoder</h1>
<h2>Limited version</h2>
-eos option must be enabled when compress file(<em>lzma.exe e inFile outFile -eos </em>)
<pre>usage:
function f(u)
@u: Array/Uint8Array
@return: Array Object

//example
var a=f([93,6,0,0,0,255,255,255,255,255,255,255,255,0,49,24,74,32,179,227,228,65,223,139,255,251,145,64])
console.log(a)//[98,97,110,97,110,97]</pre>
<p>decoder size is only 812 bytes. function name is <b>f</b>
<textarea>for(f='r(Xk=W>>>VhVU:1T--S):Rp+~bQdV5,Pb,b=O>a?Na=7NM256;L-=K+=J||(I=1H<<GHGeFfoXE;E;D1)C1C,B++]A1,@f[],);f(e=c,,j=t16+a*d)),dc=;d<L)l=o[pA==v,v=OS;):X3*a)?(iu[a]else{return 	,n=nG8|s[iAdJd+)El)>e;bJcGe++)=6],U24IhG=8=(u,a=0,c)=>{var d=Wc)?C?X8,C26C+85BkJ2,Mf,d/9,fIH024d*(UBc>nV0?(h=J2048-P0R(hKnKKPC	c},r@aDau+c	d^F},s=u,t,v,w=d%9,l,n,mF/5,gF%5,p=d=0,b,o=[hH6|gSG8,iH8-h,kDhh]=[]D;d=p&m-C1{W0a))234jRt,t=vReeR(W!5&&(M9:BkI98T187T0,tX76,6>k?k-2G6T92b>3)u=bV@O(2|b&CGSuH4>c)El=b-c;u+lE;4<uU=@n-U3@nKh&S-cEbJdG4H;4b<0)	o}}EQ;ko[eA}l=(lV8-w|(p&g)Gw)]H;7>a;Eo[Q]WeV7&@eG=@=l|k+1G8),c^k}d-LaK4NaT0N3:6}}';_=/[-@-X]/.exec(f);)with(f.split(_))f=join(shift());eval(f)</textarea>
<p>raw decoder 1057 bytes
<textarea>f=u=>{for(var a=0,b,c,d=u[0],e=d/9,f=(b,a,d=b[a]||(b[a]=1024),c=d*(h>>>11))=>(c=c>n>>>0?(h=c,b[a]+=2048-d>>5,0):(h-=c,n-=c,b[a]-=d>>5,1),h>>24||(h<<=8,n=n<<8|u[i++]),c),q=(b,a)=>f(b,0)?f(b,1)?18+r(b,8,1):10+r(b,3,a*16+261):2+r(b,3,a*16+511),r=(b,a,c,d=1,e=a)=>{for(;a--;)d+=d+f(b,d+c);return 1<<e^d},s,t,v,w=d%9,j,l,n,m=1<<e/5,g=1<<e%5,p=d=0,o=[],h=16|g--<<8,i=18-h,k;h--;n=n<<8|u[i++])f[h]=[];for(;;d=p&m-1)if(f(f[1],s=a*16+d)){if(f(f[e=k=0],a))f(f[2],a)?(f(f[3],a)?(f(f[4],a)?(e=j,j=t):e=t,t=v):e=v,v=b,b=e):(k=!f(f[5],s))&&(a=7>a?9:11),k||(k=q(f[9],d),a=7>a?8:11);else{k=q(f[8],d),a=7>a?7:10,j=t,t=v,v=b,b=r(f[7],6,6>k?k-2<<6:192);if(b>3){if(s=b>>1,d=14>b,l=16-b+(b=(2|b&1)<<--s),!d){for(l=0;4<s--;d+=d-c)h>>>=1,c=n-h>>>31,n-=h&--c,h>>24||(h<<=8,n=n<<8|u[i++]);b+=d<<++s}for(d=1;s>e;b+=c<<e++)d+=d+=c=f(f[6],d+l);if(b<0)return o}}for(e=p+~b;k--;)l=o[p++]=o[e++]}else{l=f[16+(l>>8-w|(p&g)<<w)],d=1;if(7>a)for(;d<256;)d+=d+f(l,d);else{for(e=o[p+~b];d<256;)if(k=e>>7&1,e+=e,d+=d+=c=f(l,d|k+1<<8),c^k)for(;d<256;)d+=d+f(l,d)}l=o[p++]=d-256;a-=4>a?a:9<a?6:3}}</textarea>
<p>html+js 972 bytes
<textarea id=t><input type=file oninput='for(f=`>>>qhqpA=m:1k--):_rrayZnew Ydq5,X>a?Wa=7WVL+~bT256;S))Qr(P-=N+=M||(K=1J<<IJIeHfoPG;G;F1)E1E,D++]C1,$f[#],"f(ie=c,16+,j=t);c=,d;d<S)l=o[LC==v,v=b,b=;)"a*dQ"a)?((u,a=0,c)=>:P3*#u[a]else{return 	,n=nI8|s[iCYUint8AZ(dMd+)Gl)>e;bMcIe++)=6],p24KhI=8={var d="mc)?E?P8,E26E+85DAM2,Vfiles[0].aZBuffeP).then(d.href=self.URL.createObjectURL(YBlob([uQ)]Qf,d/9,fKJ024d*(pDc>nq0?(h=M2048-X0_(hNnNNXE	c},r$aFau+c	d^H},s=u,t,v,w=d%9,l,n,BH/5,gH%5,L=d=0,b,o=["hJ6|gI8,iJ8-h,AFh#h]=[]F;d=L&B-E1{m0"aQ234j_t,t=v_ee_(m!5&&(V9:DAK#98k1#87k0,tP#7"6,6>A?A-2I6k92b>3)u=bq$b,b=(2|b&EIuJ4>c)Gl=b-c;u+lG;4<up=$n-p3$nNh&-cGbMdI4J;4b<0)	o}}GT;Ao[eC}l=#(lq8-w|(L&g)Iw)]J;7>a;Go[T]meq7&$eI=$=l|A+1I8),c^A}d-SaN4Wak0W3:6}}`;_=/[^ !%-BLORU[-^a-jlnor-~]/.exec(f);)with(f.split(_))f=join(shift());eval(f)'><a id=d download>DL</textarea>
<p>Test above code. click 'DL' to download file when process is done<iframe src=about:blank id=tt></iframe><hr>
<h2>More compatible version</h2>
<pre>usage:
function f(u)
@u: Array/Uint8Array
@return: Array Object

// without -eos
a=f([93,6,0,0,0,6,0,0,0,0,0,0,0,0,49,24,74,32,179,227,218,138,220,140]),
// with -eos
b=f([93,6,0,0,0,255,255,255,255,255,255,255,255,0,49,24,74,32,179,227,228,65,223,139,255,251,145,64]);

console.log(a,b)//[98,97,110,97,110,97], [98,97,110,97,110,97]</pre>
<p>decoder size is 835 bytes. function name is <b>f</b>. not requires -eos option. uncompressed file size limit is 2<sup>53</sup>bytes. but can't over limit of Array Object size
<textarea>for(f='r(w>>>ZhZY:1X):Wp+~bVdZ5,Ub,b=T>a?Sa=7SRk=Q-=P--O+=N||(M=1L<<KLKeJ=0,IfowH;H;G1)F1F,E++]Df[C],B256;d<;)1,);f(e=c,,j=t16+Ba*d)),dc=l=o[pD==v,v=TO;):w3*Ba)?(iu[a]else{,n=nK8|s[iD	dNd+Creturn )Hl)>e;bNcKe++)=6],Y24MhK=8	=(u,aIc)=>{var d=BQc)?F?w8,F26F+85EkN2,Rf,d/9,fML024d*(YEc>nZ0?(h=N2048-U0W(hPnPPUFc},raGau+cd^J},s=u,t,v,q=d%9,l,n,mJ/5,gJ%5,p=dIAIb,o=[Bh=gO*,iLQiGhCh]=[]Gi<18;A=A*+s[kO]	H;p<A;d=p&m-F1{Q0Ba))234jWt,t=vWeeW(Q!5&&(R9:EkMC98X1C87X0,twC7B6,6>k?k-2K6X92b>3)u=bZT(2|b&FKOuL4>c)Hl=b-c;u+lH;4<uY=n-Y3nPh&O-cHbNdK4L;4b<0)o}}HV;ko[eD}l=C(lZ8-q|(p&g)Kq)]L;7>a;Ho[V]QeZ7&eK==l-*~k),c^k}d-;aP4SaX0S3:6}o}';_=/[-B-Zw]/.exec(f);)with(f.split(_))f=join(shift());eval(f)</textarea>
<p>raw decoder 1095 bytes
<textarea>f=u=>{for(var a=0,b,c,d=u[0],e=d/9,f=(b,a,d=b[a]||(b[a]=1024),c=d*(h>>>11))=>(c=c>n>>>0?(h=c,b[a]+=2048-d>>5,0):(h-=c,n-=c,b[a]-=d>>5,1),h>>24||(h<<=8,n=n<<8|u[i++]),c),q=(b,a)=>f(b,0)?f(b,1)?18+r(b,8,1):10+r(b,3,a*16+261):2+r(b,3,a*16+511),r=(b,a,c,d=1,e=a)=>{for(;a--;)d+=d+f(b,d+c);return 1<<e^d},s,t,v,w=d%9,j,l,n,m=1<<e/5,g=1<<e%5,p=d=0,A=0,o=[],h=16|g--<<8,i=11,k=i;h--;)f[h]=[];for(;i<18;n=n<<8|u[i++])A=u[k--]+A*256;for(;p<A;d=p&m-1)if(f(f[1],s=a*16+d)){if(f(f[e=k=0],a))f(f[2],a)?(f(f[3],a)?(f(f[4],a)?(e=j,j=t):e=t,t=v):e=v,v=b,b=e):(k=!f(f[5],s))&&(a=7>a?9:11),k||(k=q(f[9],d),a=7>a?8:11);else{k=q(f[8],d),a=7>a?7:10,j=t,t=v,v=b,b=r(f[7],6,6>k?k-2<<6:192);if(b>3){if(s=b>>1,d=14>b,l=16-b+(b=(2|b&1)<<--s),!d){for(l=0;4<s--;d+=d-c)h>>>=1,c=n-h>>>31,n-=h&--c,h>>24||(h<<=8,n=n<<8|u[i++]);b+=d<<++s}for(d=1;s>e;b+=c<<e++)d+=d+=c=f(f[6],d+l);if(b<0)break}}for(e=p+~b;k--;)l=o[p++]=o[e++]}else{l=f[16+(l>>8-w|(p&g)<<w)],d=1;if(7>a)for(;d<256;)d+=d+f(l,d);else{for(e=o[p+~b];d<256;)if(k=e>>7&1,e+=e,d+=d+=c=f(l,d|k+1<<8),c^k)for(;d<256;)d+=d+f(l,d)}l=o[p++]=d-256;a-=4>a?a:9<a?6:3}return o}</textarea>
<p>html+js 990 bytes
<textarea id=u><input type=file oninput='for(f=`rray
p+~br(Zk=Y-=X--W+=V||(T=1S<<QSQeP=0,NfoZM;M;K1)J1J,I++]Hf[G],F256E;d<E;)D1,C);f(ie=c,>a?,j=t16+Fa*d)),dc=l=o[pH==v,v=b,b=W;):Z3*Fa)?((u,aNc)=>Gu[a]else{new Uint8A
(	,n=nQ8|s[iHdVd+>>>return )MDl),h24ThQ=8={var d=FYc)?J?Z8,J26J+85IkV2,a=7files[0].a
BuffeZ).then(d.href=top.URL.createObjectURL(new Blob([		u)))]))f,d/9,fTS024d*(hIc>n0?(h=V2048-d5,0):(hXnXXd5,Jc},rCaKau+cd^P},s=u,t,v,q=d%9,l,n,mP/5,gP%5,p=dNANb,o=[Fh=gW*E,iSCYiKhGh]=[]Ki<18;A=A*E+s[kW]M;p<A;d=p&m-J1{Y0Fa))234j):t,t=v):ee):(Y!5&&(a=79:IkTG98:11G87:10,tZG7F6,6>k?k-2Q6:192b>3){u=bCb,b=(2|b&JQWuS4>c)l=b-c;Ml=0;4<uh=Cn-h3CnXh&W-cbVdQ++uS}M;u>e;bVcQe++)=6]+lb<0)o}}M;ko[eH}l=G(l8-q|(p&g)Qq)]S;7>a;Mo[]DYe7&CeQ=C=l-E*~k),c^k}d-E;aX4a:103:6}o}`;_=/[^ -BLORU[-~]/.exec(f);)with(f.split(_))f=join(shift());eval(f)'><a id=d download>DL</textarea>
<p>Test above code. click 'DL' to download file when process is done<iframe src=about:blank id=uu></iframe>
<script>for(let a of"tu")self[a+a].srcdoc=self[a].value</script>
